buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath("org.cloudfoundry:cf-gradle-plugin:1.0.5")
    }
}

plugins {
    id 'org.asciidoctor.convert' version '1.5.3'
    id 'com.github.jruby-gradle.base' version '1.2.0'
}
apply plugin: 'cloudfoundry'
apply plugin: 'scala'

repositories {
    jcenter()
}

ext {
    akkaV = "2.3.9"
    sprayV = "1.3.3"
}

dependencies {
    compile group: 'com.typesafe.akka', name: 'akka-actor_2.11', version: akkaV
    compile group: 'io.spray', name: 'spray-can_2.11', version: sprayV
    compile group: 'io.spray', name: 'spray-routing_2.11', version: sprayV
    compile group: 'io.spray', name: 'spray-json_2.11', version: "1.3.1"
}

asciidoctor {
    dependsOn jrubyPrepare
    gemPath = jrubyPrepare.outputDir

//    attributes 'toc2': '',
//            'toclevels': 2,
//            stylesdir: './stylesheets',
//            imagesdir: './images',
//            iconsdir: './icons',
//            scriptsdir: './js',
//            stylesheet: 'golo.css',
//            grailsDocDir: 'http://grails.org/doc/latest',
//            'source-highlighter': 'prettify',
//            //    'source-highlighter': 'highlightjs',
//            'highlightjs-theme': 'idea',
//            doctype: 'book',
//            icons: 'font',
//            encoding: 'utf-8',
//            linkcss: true,
//            grailsVersion: '3.0.11',
//            jvmVersion: '1.8.0_66',
//            sectanchors: ''
}

cloudfoundry {
    target = 'https://api.run.pivotal.io'
    space = 'workshop'
    application = 'akka-workshop'
    file = file('build/asciidoc/html5')
    buildpack = 'staticfile_buildpack'
    memory = 64
    instances = 1
}

cfPush.dependsOn asciidoctor

apply plugin: 'org.asciidoctor.gradle.asciidoctor'
